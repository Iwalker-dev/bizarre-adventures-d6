<form class="sheet hit-item-sheet" autocomplete="off">
  <header class="sheet-header">
    <h1>{{item.name}}</h1>
  </header>
{{!-- Future optimization, hit items extend item options.--}}
  <div class="sheet-body">
    <div class="form-group">
      <label for="hit-name">Name:</label>
      <input type="text" id="hit-name" name="name" value="{{item.name}}" />
    </div>

    <div class="form-group">
      <label for="hit-weight">Weight:</label>
      <input type="number" id="hit-weight" name="system.weight" value="{{item.system.weight}}" min="0" />
    </div>

    <div class="form-group">
      <label for="hit-quantity">Quantity:</label>
      <input type="number" id="hit-quantity" name="system.quantity" value="{{item.system.quantity}}" min="0" />
    </div>

    <div class="form-group">
      <label for="hit-description">Description:</label>
      <textarea id="hit-description" name="system.description" rows="4">{{item.system.description}}</textarea>
    </div>

    <div class="formula-body">
    <h2>Formula</h2>

    <div class="formula-row header">
      <div class="col order">Optional | Stat | Variable | Operand | Value | Actions</div>
    </div>

    <div class="formula-rows">
      {{#each item.system.formula.lines}}
        <div class="formula-row" data-index="{{@index}}">
          <div class="col optional">
            <input type="checkbox" name="system.formula.lines.{{@index}}.optional" {{#if optional}}checked{{/if}} />
          </div>

          <div class="col stat">
            <select name="system.formula.lines.{{@index}}.variable">
              {{!-- If a variable list becomes necessary, it can be populated like...
              {{#if ../system.variables}}
                {{#each ../system.variables}}
                  <option value="{{this.key}}">{{this.label}}</option>
                {{/each}}
                -- current hardcoded options (allows ignoring of linked actor conflicts):
                'power', 'precision', 'speed', 'range', 'durability', 'learning'
                "body", "luck", "menacing", "pluck", "reason", "wit"
              --}}
                <option value="power">Power</option>
                <option value="precision">Precision</option>
                <option value="speed">Speed</option>
                <option value="range">Range</option>
                <option value="durability">Durability</option>
                <option value="learning">Learning</option>
                <option value="body">Body</option>
                <option value="luck">Luck</option>
                <option value="menacing">Menacing</option>
                <option value="pluck">Pluck</option>
                <option value="reason">Reason</option>
                <option value="wit">Wit</option>
            </select>
          </div>

          <div class="col variable">
            <select name="system.formula.lines.{{@index}}.variable">
              {{!-- example formula: (@stat)d(@sides)cs>=(@advantage) + (@modifier) --}}
                <option value="stat">Stat</option>
                <option value="sides">Sides</option>
                <option value="advantage">Advantage</option>
                <option value="modifier">Result</option>
            </select>
          </div>

          <div class="col operand">
            <select name="system.formula.lines.{{@index}}.operand">
              <option value="+">+</option>
              <option value="-">-</option>
              <option value="*">*</option>
              <option value="/">/</option>
              <option value="=">=</option>
            </select>
          </div>

          <div class="col value">
            <input type="number" name="system.formula.lines.{{@index}}.value" value="{{value}}" step="1" />
          </div>

          <div class="col actions">
            <button type="button" class="remove-formula-line" data-index="{{@index}}">Remove</button>
          </div>
        </div>
      {{/each}}

    {{#unless item.system.formula.lines}}
      <div class="formula-row empty">
        <em>No formula lines yet. Use Add Line to create one.</em>
      </div>
    {{/unless}}
    </div>

    <div class="formula-controls">
      <button type="button" class="add-formula-line">Add Line</button>
    </div>

  </div>
</form>